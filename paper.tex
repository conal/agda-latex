\newif\iftalk
\newif\ifacm

%% \acmtrue

\ifacm
\documentclass[acmsmall,screen,timestamp]{acmart}  % ,anonymous,review
\else
\documentclass[acmsmall,screen,timestamp,nonacm]{acmart}
\fi
\authorsaddresses{}

\usepackage{catchfilebetweentags}

\RequirePackage{newunicodechar, stmaryrd, setspace, comment, scalerel}

\input{commands}
\input{unicode}
\input{macros}

\definecolor{mylinkcolor}{rgb}{0,0.2,0}
\hypersetup{
  linkcolor  = mylinkcolor,
  citecolor  = mylinkcolor,
  urlcolor   = mylinkcolor,
  colorlinks = true, % false
}

\bibliographystyle{ACM-Reference-Format}
\citestyle{acmauthoryear}
\setcitestyle{nosort}

%% I prefer ∅ in XITSMath-Regular, but I don't know how to make setmathfont
%% work with acmart.
\newunicodechar{◇}{\raisebox{0.02ex}{\ensuremath{_{\diamond}\hspace{-0.323em}}}}
\newunicodechar{□}{\raisebox{-0.12ex}{\ensuremath{\scaleobj{0.4}{\Box}}\hspace{-0.238em}}}

\usepackage{libertine}  %% [tt=false]
\usepackage{agda}% references

%% I think acmart minimizes these two.

%% Switching to \textsf for AgdaFunction messes up vertical alignment.
%% \newcommand{\AgdaFontStyle}[1]{\textsf{#1}}

%% \renewcommand{\AgdaFontStyle}[1]{\text{#1}}

%% \renewcommand{\AgdaFunction}[1]
%%     {\AgdaNoSpaceMath{\text{\textcolor{AgdaFunction}{\AgdaFormat{#1}{\AgdaLink{#1}}}}}}
%% \renewcommand{\AgdaRecord}[1]
%%     {\AgdaNoSpaceMath{\text{\textcolor{AgdaRecord}{\AgdaFormat{#1}{\AgdaLink{#1}}}}}}

%% \rnc\AgdaTarget[1]{}

\author{Conal Elliott}

\begin{document}

\setlength{\abovedisplayskip}{1.5ex}
\setlength{\belowdisplayskip}{1.5ex}
\setlength{\abovedisplayshortskip}{0ex}
\setlength{\belowdisplayshortskip}{0ex}

\nc\tit{Working Title}

\title{\tit}
\date{Version of \DTMnow{} GMT-8}

\begin{abstract}
...
\end{abstract}

\maketitle
\mathindent2em

\sectionl{Introduction}
\rnc\source{Introduction}

\bibliography{bib}

\end{document}
